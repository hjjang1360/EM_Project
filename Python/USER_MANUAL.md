# 🍺 BAC Calculator 사용자 매뉴얼 v2.0 (Updated)

## 📋 v2.0 업데이트 내용

### 🔧 주요 개선사항
- **정확한 회복 시간 예측**: 피크 후 시점만 고려하여 현실적인 예측 제공
- **한글 폰트 개선**: 그래프에서 한글 텍스트 정상 표시
- **신뢰성 향상**: t=0 오인식 문제 해결로 더 정확한 계산

### 🆕 새로운 파일들
- `bac_calculator_web_fixed.py`: 모든 수정사항이 적용된 웹 앱
- `launcher_updated.py`: 업데이트된 통합 런처
- `test_recovery_fix.py`: 수정사항 검증 도구

## 목차
1. [빠른 시작](#빠른-시작)
2. [GUI 애플리케이션 사용법](#gui-애플리케이션-사용법)
3. [웹 애플리케이션 사용법](#웹-애플리케이션-사용법)
4. [커맨드라인 애플리케이션 사용법](#커맨드라인-애플리케이션-사용법)
5. [결과 해석](#결과-해석)
6. [수정사항 검증](#수정사항-검증)
7. [자주 묻는 질문](#자주-묻는-질문)
8. [문제 해결](#문제-해결)

## 빠른 시작

### 🚀 가장 빠른 시작 방법
```bash
# 업데이트된 런처 실행 (모든 앱을 한 곳에서)
python launcher_updated.py
```

### 개별 앱 실행
```bash
# 수정된 웹 앱 (가장 추천) ⭐
python bac_calculator_web_fixed.py

# GUI 버전 (수정됨)
python bac_calculator_gui.py

# 커맨드라인 버전 (수정됨)
python bac_calculator_simple.py
```

### 2단계: 정보 입력
- 개인정보: 성별, 나이, 몸무게
- 음주정보: 술 종류, 음주량

### 3단계: 결과 확인
- BAC 그래프 보기 (한글 표시 개선됨)
- **정확한** 회복 시간 확인 (v2.0에서 개선됨)

## 웹 애플리케이션 사용법

### 수정된 웹 앱 특징 (`bac_calculator_web_fixed.py`)
- 🔧 개선된 회복 시간 예측 로직
- 🎨 한글 폰트 자동 설정
- 📊 개선된 그래프 표시
- ⚡ 실시간 계산 및 표시

### 웹앱 실행 방법
1. 터미널에서 `python bac_calculator_web_fixed.py` 실행
2. 브라우저에서 `http://localhost:5000` 접속
3. 정보 입력 후 "계산하기" 클릭
4. 결과 그래프 및 회복 시간 확인

## GUI 애플리케이션 사용법

### 인터페이스 구성 (개선됨)
```
┌─────────────────────────────────────────────────────────┐
│                 입력 정보 (한글 표시 개선)                 │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│ │  개인정보    │ │  음주정보    │ │    계산     │        │
│ └─────────────┘ └─────────────┘ └─────────────┘        │
├─────────────────┬───────────────────────────────────────┤
│   결과 (개선됨)  │        BAC 그래프 (한글 폰트 개선)        │
│  정확한 회복시간 │                                      │
│                │                                      │
└─────────────────┴───────────────────────────────────────┘
```

### 단계별 사용법

#### 1단계: 개인정보 입력
![개인정보 입력](user_manual_personal.png)

**필수 입력 항목:**
- **성별**: 드롭다운에서 선택 (남성/여성)
  - 남성: 체수분 비율 68%
  - 여성: 체수분 비율 55%
- **나이**: 숫자 입력 (19-100세)
  - 나이가 증가하면 체수분 비율 약간 감소
- **몸무게**: kg 단위로 입력 (30-200kg)
- **키**: cm 단위로 입력 (140-200cm, 선택사항)

**팁:**
- 정확한 몸무게가 가장 중요합니다
- 나이는 체수분 비율 계산에 사용됩니다

#### 2단계: 음주정보 입력

**술 종류 선택:**
- **맥주**: 5%, 기본 500mL
- **소주**: 17%, 기본 360mL  
- **와인**: 12%, 기본 150mL
- **위스키**: 40%, 기본 50mL
- **막걸리**: 6%, 기본 300mL
- **직접입력**: 사용자 정의

**음주량 조정:**
- 기본값에서 실제 마신 양으로 조정
- mL 단위로 입력

**음주 시작 시간:**
- HH:MM 형식으로 입력
- 회복 시간 계산에 사용

#### 3단계: 모델 선택

**분수계 모델 (권장):**
- 메모리 효과 포함
- 더 현실적인 예측
- 보수적(안전한) 결과

**고전 모델:**
- 단순한 지수 감소
- 빠른 계산
- 전통적인 방법

#### 4단계: 계산 실행

**"🧮 BAC 계산하기" 버튼 클릭**
- 즉시 계산 실행
- 그래프 자동 업데이트
- 결과 텍스트 표시

### 결과 화면 구성

#### 왼쪽: 상세 결과 텍스트
```
=== BAC 계산 결과 ===

📋 입력 정보:
• 성별: 남성
• 나이: 25세
• 몸무게: 70kg
• 음주량: 500mL
• 알코올 도수: 5%
• 순수 알코올: 19.7g
• 모델: 분수계 모델

📊 계산 결과:
• 초기 농도 (A0): 0.414 g/L
• 최고 BAC: 42.3 mg/100mL
• 최고점 도달: 음주 후 1.2시간

⏰ 회복 시간 예측:
🚗 운전 가능 (50mg/100mL 이하):
   음주 후 0.8시간 (21:48)

✅ 안전 운전 (30mg/100mL 이하):
   음주 후 2.1시간 (23:06)

🎉 완전 회복 (10mg/100mL 이하):
   음주 후 4.5시간 (01:30)
```

#### 오른쪽: BAC 그래프
- **빨간 선**: BAC 변화 곡선
- **점선들**: 법적 기준선
  - 빨간 점선: 80 mg/100mL (음주운전 단속)
  - 주황 점선: 50 mg/100mL (면허정지)
  - 초록 점선: 30 mg/100mL (안전 기준)
  - 파란 점선: 10 mg/100mL (완전 회복)
- **세로 점선들**: 회복 시간 마커

## 커맨드라인 애플리케이션 사용법

### 프로그램 시작
```bash
python bac_calculator_simple.py
```

### 대화형 입력 과정

#### 1단계: 개인정보 입력
```
🍺 혈중알코올농도(BAC) 계산기
========================================

👤 개인정보를 입력해주세요:
성별 (남성/여성): 남성
나이: 25
몸무게 (kg): 70
```

#### 2단계: 음주정보 입력
```
🍻 음주정보를 입력해주세요:
술 종류를 선택하세요:
1. 맥주 (5%, 500mL)
2. 소주 (17%, 360mL)
3. 와인 (12%, 150mL)
4. 위스키 (40%, 50mL)
5. 막걸리 (6%, 300mL)
6. 직접입력
선택 (1-6): 1

선택된 술: 맥주
음주량 (기본값: 500mL, Enter로 기본값 사용): 
```

#### 3단계: 모델 선택
```
모델을 선택하세요:
1. 분수계 모델 (메모리 효과 포함, 더 정확)
2. 고전 모델 (단순한 지수 감소)
선택 (1-2): 1
```

#### 4단계: 시간 입력
```
음주 시작 시간 (HH:MM, 기본값: 20:30): 
```

### 결과 확인

#### 텍스트 결과
자세한 계산 결과가 터미널에 표시됩니다.

#### 그래프 표시
```
그래프를 보시겠습니까? (y/n): y
```
matplotlib 창에서 그래프가 표시됩니다.

#### 재계산
```
다시 계산하시겠습니까? (y/n): n
```

## 결과 해석

### BAC 수치 의미

| BAC (mg/100mL) | 상태 | 설명 |
|---|---|---|
| 0-10 | 정상 | 완전 회복 상태 |
| 10-30 | 주의 | 약간의 영향, 안전운전 가능 |
| 30-50 | 경고 | 운전 능력 저하, 주의 필요 |
| 50-80 | 위험 | 면허정지 수준, 운전 금지 |
| 80+ | 매우위험 | 면허취소 수준, 절대 운전 금지 |

### 회복 시간 가이드

**운전 가능 시간 (50mg/100mL 이하):**
- 법적으로 운전 가능한 최소 기준
- 하지만 여전히 주의 필요

**안전 운전 시간 (30mg/100mL 이하):**
- 실질적으로 안전한 운전 기준
- 권장하는 운전 재개 시점

**완전 회복 시간 (10mg/100mL 이하):**
- 알코올의 영향이 거의 없는 상태
- 완전히 안전한 상태

### 그래프 읽는 법

1. **피크 지점**: 가장 높은 BAC 수치와 시간
2. **기준선 교차**: 각 기준을 통과하는 시점
3. **곡선 모양**: 
   - 분수계 모델: 완만한 곡선
   - 고전 모델: 더 급격한 변화

## 수정사항 검증

### 🧪 테스트 도구 사용법

#### 1. 간단한 검증 도구
```bash
python simple_recovery_test.py
```

**예상 출력:**
```
Recovery Time Logic Test
========================================
Test scenario: Male, 25y, 70kg, Soju 360mL 17%
A0 = 1.014 g/L
Alcohol mass = 48.3g

Peak BAC: 42.1 mg/100mL at 2.0 hours

OLD METHOD (problematic):
  Legal: None
  Safe: None  
  Full: None

NEW METHOD (fixed):
  Legal (50mg): 2.1h
  Safe (30mg):  4.9h
  Full (10mg):  16.6h

ANALYSIS:
The old method likely finds t=0 where BAC=0
The new method correctly finds recovery AFTER peak
✅ Test complete!
🔧 The fix ensures we only look AFTER the peak time.
```

#### 2. 상세한 비교 테스트 (그래프 포함)
```bash
python test_recovery_fix.py
```

**기능:**
- 기존 vs 수정된 로직 비교
- 시각적 그래프 생성
- 한글 폰트 표시 테스트
- `recovery_time_comparison.png` 파일 생성

### 🔍 수정사항 확인 체크리스트

#### ✅ 회복 시간 로직 확인
1. **기존 문제**: 모든 회복 시간이 "None" 또는 0시간으로 표시
2. **수정 후**: 현실적인 회복 시간 표시 (예: 2.1h, 4.9h, 16.6h)

#### ✅ 한글 폰트 확인  
1. **기존 문제**: 그래프에서 한글이 네모박스(□□□)로 표시
2. **수정 후**: 한글 텍스트가 정상적으로 표시

#### ✅ 피크 시간 로직 확인
1. **기존 문제**: t=0에서 BAC=0을 "회복"으로 잘못 인식
2. **수정 후**: 피크 시간 이후만 고려하여 정확한 예측

## 자주 묻는 질문

### Q1: 어떤 모델을 선택해야 하나요?
**A:** 분수계 모델을 권장합니다. 메모리 효과를 고려하여 더 현실적이고 보수적인 예측을 제공합니다.

### Q2: 계산 결과가 실제와 다를 수 있나요?
**A:** 네, 개인차가 있을 수 있습니다. 대사율, 체지방률, 음식 섭취 등이 영향을 줍니다.

### Q3: 음식을 먹고 마신 경우는 어떻게 하나요?
**A:** 현재 모델은 공복 상태를 가정합니다. 음식을 먹은 경우 흡수가 늦어질 수 있습니다.

### Q4: 여러 종류의 술을 마신 경우는?
**A:** 총 알코올량을 계산해서 "직접입력"으로 넣으시면 됩니다.

### Q5: 왜 분수계 모델이 더 정확한가요?
**A:** 메모리 효과를 고려하여 알코올의 흡수와 제거 과정을 더 현실적으로 모델링합니다.

## 문제 해결

### 프로그램이 실행되지 않는 경우

**Python 버전 확인:**
```bash
python --version
```
Python 3.7 이상 필요

**필요 패키지 설치:**
```bash
pip install numpy matplotlib scipy
```

### GUI가 나타나지 않는 경우

**tkinter 설치 확인:**
```bash
python -c "import tkinter"
```

**Linux/Mac의 경우:**
```bash
# Ubuntu/Debian
sudo apt-get install python3-tk

# macOS
brew install python-tk
```

### 그래프가 나타나지 않는 경우

**matplotlib 백엔드 확인:**
```python
import matplotlib
print(matplotlib.get_backend())
```

**백엔드 변경:**
```python
import matplotlib
matplotlib.use('TkAgg')  # or 'Qt5Agg'
```

### 계산 결과가 이상한 경우

**입력값 확인:**
- 몸무게: 30-200kg 범위
- 음주량: 10-2000mL 범위
- 알코올 도수: 0.5-60% 범위

**로그 확인:**
- 오류 메시지 확인
- 콘솔 출력 확인

### 성능 문제

**계산이 느린 경우:**
- 분수계 모델이 고전 모델보다 계산 시간이 길 수 있습니다
- 컴퓨터 성능에 따라 1-5초 정도 소요

**메모리 문제:**
- 프로그램 재시작
- 다른 프로그램 종료

## 연락처

문제가 지속되거나 추가 도움이 필요한 경우:
- 프로젝트 담당자에게 문의
- GitHub Issues 페이지 활용

---

*이 매뉴얼이 도움이 되셨나요? 피드백을 보내주세요!*
