아래 코드는 논문의 방법(Methodology) 절에 따라 Caputo 분수 미분 방정식을 이용해 혈중 알코올 농도(BAC)를 계산하고, 주어진 기준(BAC=0.08% 및 0.01%)에 도달하는 시간을 찾는 전체 파이썬 예제입니다. 필요한 라이브러리는 `numpy`, `scipy`, `matplotlib`이며, Mittag–Leffler 함수는 직접 급수로 근사합니다. 사용 전에 파라미터(체중, 성별, 음주량, k1, k2, α, β 등)를 원하는 값으로 조정해 실행하시면 됩니다.
### 코드 설명

1. **파라미터 설정(1\~8줄)**

   * `m`, `gender` 등으로 사용자의 체중·성별·음주량·알코올 도수 등을 입력합니다.
   * `k1`, `k2`, `alpha`, `beta`는 분수 미분 모델의 상수 및 차수를 지정합니다.
   * `BAChigh`, `BAClow`는 각각 0.08%(0.0008)와 0.01%(0.0001)에 해당하며, 이 기준을 넘거나 회복하는 시점을 찾습니다.
   * `Tmax`와 `J`는 시뮬레이션 전체 시간(예: 8시간)과 구간 개수(예: 800)를 설정합니다.

2. **초기 농도 A0 계산(11\~15줄)**

   * 논문에 제시된 대로

     ```
     A0 = V * (ABV/100) * ρ_EtOH / (r * m)
     ```

     로 계산합니다. 여기서 `r`은 체중 대비 체수분 분포 비율입니다.

3. **Mittag–Leffler 함수 근사(19\~42줄)**

   * 분수 미분 방정식의 해를 구할 때 등장하는 1-파라미터 및 2-파라미터 Mittag–Leffler 함수를 급수로 근사합니다.
   * `mittag_leffler(z, α)` 함수는

     $$
     E_{α}(z) = \sum_{n=0}^{\infty} \frac{z^n}{\Gamma(α n + 1)}
     $$

     형태를 최대 `max_terms` 항까지 더해 근사합니다.
   * `mittag_leffler_double(x, y, α, β)` 함수는

     $$
     E^{(2)}_{α,β}(x, y) = \sum_{m=0}^{\infty} \sum_{n=0}^{\infty} \frac{x^m\, y^n}{\Gamma(α m + β n + 1)}
     $$

     형태를 이중 반복문으로 근사합니다.

4. **분수 모델 해(A(t), B(t)) 정의(44\~60줄)**

   * 논문의 (3)식에 따라

     $$
     A(t) = A_0 \,E_{α}\bigl(-k_1 t^{α}\bigr)
     $$

     를 `A_frac(t)`로 구현했습니다.
   * 논문의 (4)식에 따라

     $$
     B(t) = k_1 A_0 \, t^{β - 1} \, E^{(2)}_{α,β}\bigl(-k_1 t^{α}, -k_2 t^{β}\bigr)
     $$

     를 `B_frac(t)`로 구현했습니다.

5. **시간 그리드 계산(62\~64줄)**

   * 0부터 `Tmax`까지 `J+1`개의 균등한 시간 간격 배열 `t`를 생성합니다.
   * 그 위에서 `A_vals = A_frac(t)`와 `B_vals = B_frac(t)`를 계산합니다.

6. **기준 시간 찾기(67\~93줄)**

   * `find_threshold_time` 함수에서 이분법을 통해 `func(t) = threshold`인 `t`를 구합니다.
   * 먼저 peak 시점 `t_max`를 `np.argmax(B_vals)`로 찾고,
   * `t ∈ [0, t_max]` 구간에서 BAC가 0.08%(`BAChigh`)를 처음 넘는 시점 `ti`를 찾습니다.
   * `t ∈ [t_max, Tmax]` 구간에서 BAC가 0.01%(`BAClow`)로 떨어지는 시점 `tf`를 찾습니다.
   * 두 시점이 존재하면 `∆T = tf - ti`를 허용 시간으로 계산합니다.

7. **결과 시각화(96\~109줄)**

   * `matplotlib`으로 BAC 곡선을 그리고, `ti`, `t_max`, `tf` 위치에 수직선을 그려 표시합니다.
   * 각 수직선에는 해당 시점을 `h` 단위로 레이블에 출력합니다.

8. **결과 콘솔 출력(112\~121줄)**

   * `A0`, `ti`, `tf`, `∆T`를 한눈에 확인할 수 있도록 출력합니다.
   * 만약 `ti` 또는 `tf`를 찾지 못했다면 해당 메시지를 나타냅니다.
